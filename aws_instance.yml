- name: Launch EC2 instances
  hosts: localhost
  vars:
    ami_image: ami-04468e03c37242e1e
    security_group_id: sg-0fd97709d8bdec1c7
    vpc_subnet_id: subnet-11358577
    instance_type: t2.micro
    instance_key: id_rsa
  tasks:
    
    - name: Launch EC2 instance for Kubernetes master
      amazon.aws.ec2:
        key_name: "{{ instance_key }}"
        instance_type: "{{ instance_type }}"
        image: "{{ ami_image }}"
        wait: yes
        group: "{{ security_group_id }}"
        count: 1
        vpc_subnet_id: "{{ vpc_subnet_id }}"
        assign_public_ip: yes
        instance_tags: 
          Name: master
        
    - name: Launch EC2 instance for Kubernetes slave
      amazon.aws.ec2:
        key_name: "{{ instance_key }}"
        instance_type: "{{ instance_type }}"
        image: "{{ ami_image }}"
        wait: yes
        group: "{{ security_group_id }}"
        count: 2
        vpc_subnet_id: "{{ vpc_subnet_id }}"
        assign_public_ip: yes
        instance_tags: 
          Name: slave